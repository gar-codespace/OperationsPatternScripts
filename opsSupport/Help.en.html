<!DOCTYPE html>
<html lang="en">
<head>
<title>Pattern Scripts Help</title>
<meta charset="utf-8">
<meta name="AUTHOR" content="Greg Ritacco">
<meta name="PROJECT" content="Pattern scripts for JMRI">
<meta name="VERSION" content="2.0.0">
<style>
  html * {
    font-family: verdana;
  }
  h1 {
    margin-left: 10px;
  }
  h2 {
    margin-left: 10px;
  }
  h3 {
    margin-left: 20px;
  }
  h4 {
    margin-left: 30px;
  }
  p {
    margin-left: 30px;
  }
  img {
    margin-left: 30px;
  }
  pre {
    margin-left: 30px;
  }
</style>
</head>
<body>
<h1>Help Page - Pattern Scripts plugin for JMRI</h1>
<p>The Pattern Scripts plugin for JMRI is a suite of subroutines for JMRI Operations Pro. The use of this plugin is documented in the following list of YouTube videos. The videos are recorded in the English language.</p>
<h3>Pattern Scripts plugin - Video Documentation</h3>
<p><A HREF="https://youtu.be/vFeCn1d2YfI">An overview of this plugin</A></p>
<p><A HREF="https://youtu.be/Sl9yBQaRpeY">How to add this plugin to JMRI</A></p>
<p><A HREF="https://youtu.be/6G7xkRJTczo">How to translate this plugin</A></p>
<p><A HREF="https://youtu.be/GjPtXk3oKmc">How to set up this plugin</A></p>
<p><A HREF="https://youtu.be/DK6O9AQmqXo">How to modify this plugin</A></p>
<h3>Subroutines - Video Documentation</h3>
<p><A HREF="https://youtu.be/rlUfoSesnQo">The o2o subroutine - Use JMRI with TrainPlayer© model railroad software</A></p>
<p>The Patterns subroutine - Overview</p>
<p><A HREF="https://youtu.be/2Tv6sUMDD_Y">The Patterns subroutine - Demonstration at industry</A></p>
<p><A HREF="https://youtu.be/IdXvxyo-E3Y">The Patterns subroutine - Demonstration at a yard</A></p>
<p><A HREF="https://youtu.be/5YleSgJGN9k">The Throwback subroutine - Run what-if scenarios with convenient return-to points</A></p>
<h2>Pattern Scripts plugin</h2>
<h3>Introduction</h3>
<p>The Pattern Scripts plugin can be thought of as a framework for hosting subroutines (or scripts) for JMRI Operations Pro that require a user interface. This plugin comes with four subroutines; jPlus, Patterns, o2o and Throwback. A template is also included to serve as scaffolding for someone wishing to add their own subroutine.</p>
<p>Subroutines may be added or removed individually as needed.</p>
<p>Additionally, each subroutine can be shown or hidden as needed, fron the Tools menu pulldown.</p>
<p>Each of the subroutines' features are only available when the plugin is running and the subroutine has been included. For example, extended railroad details will only appear in reports when the Pattern Scripts plugin has been started, and jPlus has been included. To deactivate the plugins features, close (not hide) the Pattern Scripts Swindow.</p>
<h3>Reporting</h3>
<p>This plugin can generate four types of reports:</p>
<p>1. Train List. When activated, building a train will generate an OPS train list, detailing the cars on train for each location along the train's route.</p>
<p>2. Work Order. When activated, a work order will be generated for a train when built. The WO details tasks scheduled for each location along the trains route.</p>
<p>3. Pattern Report. When using the Patterns subroutine, a pattern report for a location will detail inventory data for selected tracks.</p>
<p>4. Switch List. When using the Patterns subroutine, a switch list can be generated for any track. Switch crews would use these lists to perform their duties.</p>
<p>To activate or deactivate the train list and work order, select Tools - Extended Reports on or off.</p>
<p>Note: The train list and work order can be thought of as alternative interpretations of JMRI manifest and switch list, with the train list substituting for the manifest and the work order substituting for the JMRI switch list.
  Both reports are built from a JMRI created manifest json file.</P>
<h3>Formatting</h3>
<p>All the OPS reports are built from json files. The json created by this plugin follow the data structure of the JMRI manifest json.</p>
<p>To the extent possible, the CSV generated by this plugin follows JMRI CSV formatting.</p>
<h3>Organization</h3>
<p>The following chart shows the code structure of this plugin.</P>
<img src="./img/Code_Structure.png" alt="<Code Structure Image>">
<h3>Plugin Layout</h3>
<p>OperationsPatternScripts.MainScript.View.makePatternScriptsWindow()</p>
<img src="./img/Plugin_Layout.png" alt="<Plugin Layout Image>">
<h3>configFile.json</h3>
<p>Each JMRI profile gets its own configuration file, which is named configFile.json. It is found in the operations folder, and is used to provide custom settings for each profile and record user inputs.</p>
<p>Select Tools/Edit Config File. The values that are user editable are in subsections labeled "US" for User Settings. Other values should not be edited. If a mistake is made editing the configFile, the plugin will delete the file and provide a new one to start over using default values. Worst case, the plugin may crash. If that should happed select Tools/Restart From Default.</p>
<h4>User Settings for the Main Script section of configFile.json</h4>
<pre>
  The following are user editable values for the plugin.
  For colors, any of the A, B, G, R values can be changed, between 0 and 255.
  Also, new colors may be added.

  "US" : {
    "OPR" : "pattern report ({}).{}", <font color="DarkRed">OPS Pattern Report file name.</font>
    "OSL" : "switch list ({}).{}", <font color="DarkRed">OPS Switch List file name.</font>
    "OTL" : "train list ({}).{}", <font color="DarkRed">OPS Train List file name.</font>
    "OWO" : "work order ({}).{}", <font color="DarkRed">OPS Work Order file name.</font>
    "HCP" : " [ ] Hold", <font color="DarkRed">Hold car prefix.</font>
    "AW": { <font color="DarkRed">Attribute Width. In any OPS report, the number of characters alloted to each attribute.</font>
      " ": 1, 
      "Color": 6, 
      "Comment": 15, 
      "Consist": 8, 
      "DCC_Address": 10, 
      "Destination": 15, 
      "Dest&Track": 27, 
      "FD&Track": 23, 
      "Division": 15, 
      "Final_Dest": 11, 
      "Hazardous": 10, 
      "Kernel": 7, 
      "Kernel_Size": 3, 
      "Length": 3, 
      "Load": 12, 
      "Load_Type": 1, 
      "Location": 9, 
      "Number": 5, 
      "Model": 5, 
      "Owner": 20, 
      "PickUp_Msg": 12, 
      "RWE": 10, 
      "RWL": 10, 
      "Road": 4, 
      "SetOut_Msg": 12, 
      "Track": 12, 
      "Type": 3, 
      "Weight": 7
      },
      "OC" : true, <font color="DarkRed">Open Console. Opens the system console when the plugin starts.</font>
      "OT" : false, <font color="DarkRed">Open Trains window when plugin starts. (Not being used)</font>
    "CD": { <font color="DarkRed">Color Definitions, a set of predefined colors.</font>
        "BLANCH": { <font color="DarkRed">The name of the color.</font>
          "A": 210, <font color="DarkRed">The alpha (transparency) value.</font>
          "B": 255, <font color="DarkRed">The blue component value.</font>
          "D": "Lighten a bit", <font color="DarkRed">A description of the color.</font>
          "G": 255, <font color="DarkRed">The green component value.</font>
          "R": 255 <font color="DarkRed">The red component value.</font>
        },
        "GLOOM": {
          "A": 10,
          "B": 0,
          "D": "Darken a bit",
          "G": 0,
          "R": 0
        },
        "DUST": {
          "A": 255,
          "B": 218,
          "D": "Light tan",
          "G": 242,
          "R": 252
        },
        "FADED": {
          "A": 255,
          "B": 245,
          "D": "Light purple",
          "G": 225,
          "R": 237
        },
        "LICHEN": {
          "A": 255,
          "B": 244,
          "D": "Light green",
          "G": 255,
          "R": 236
        },
        "PALE": {
          "A": 255,
          "B": 250,
          "D": "Light blue",
          "G": 243,
          "R": 237
        },
        "RASH": {
          "A": 255,
          "B": 224,
          "D": "Light red",
          "G": 208,
          "R": 240
        },
        "colorA" : "DUST", <font color="DarkRed">The name of the color to be used when colorA is called.</font>
        "colorB" : "FADED", <font color="DarkRed">The name of the color to be used when colorB is called.</font>
        "colorC" : "RASH" <font color="DarkRed">The name of the color to be used when colorC is called.</font>
      }
    },
</pre>
<!-- jPlus help section html -->
<h2>jPlus Subroutine</h2>
<h3>Description</h3>
<p>The jPlus subroutine adds extended railroad detail to reports generated by this plugin. This detail is displayed as the header any OPS report. The header for the JMRI server is not changed.</P>
<h3>How to use this subroutine</h3>
<p>To use this subroutine. enter the appropriate data into the text box and click update. Not all fields need to be entered.</P>
<h4>Operating Railroad Name</h4>
<p>This is railroad that owns or operates the tracks being modeled. Any name can be entered such as 'PRR' or 'BN UPRR Joint' or 'G&D'.</P>
<h4>Operational Territory</h4>
<p>This is the railroad's name for the part being modeled, such as 'Long Beach Intermodal Terminal' or 'Salem Glass Works Branch'.</P>
<h4>Location</h4>
<p>Where the the railroad is located, such as 'The Great Divide' or 'The Bronx, New York'.</P>
<h4>Year Modeled</h4>
<p>Which year the model railroad is based on, this is a mirror of 'JMRI/OperationsPro/Settings/Year Modeled'. Either updates the other.</p>
<h4>Update</h4>
<p>Pressing the Update button stores the values entered into the text boxes in the configuration file.</p>
<h4>Use Extended Header</h4>
<p>Checking this box will include the extended header information in any of the OPS reports.</p>
<h3>Subroutine Panel</h3>
<p>Subroutines.jPlus.View.ManageGui</p>
<img src="../Subroutines_Activated/jPlus/img/j_Plus_Subroutine.png" alt="<jPlus Subroutine Image>">
<h4>User Settings for the jPlus section of configFile.json</h4>
<pre>
  The jPlus section of the configuration file has no user editable settings.
</pre>
<!-- o2o help section html -->
<h2>o2o Subroutine</h2>
<h3>Description</h3>
<p>The ops to ops (o2o) subroutine is a group of utilities that are designed to be the glue that allows JMRI Operations Pro to be the operations engine for TrainPlayer©. The idea is to expand the capability of TrainPlayer©'s Advanced Ops feature to include the flexibility of Operations Pro, while also eleminating the tedium of keeping two data sets synchronised.</p>
<p>o2o will automatically export a built train or switchlist to TrainPlayer when the Pattern Scripts window is open and the o2o subroutine is included. To disable o2o export, Remove o2o from the Pattern Scripts window or close (not hide) the Pattern Scripts window.</p>
<h3>How to use this subroutine</h3>
<p>Before any of these buttons are pressed, export your layout from TrainPlayer. The QuickKeys for TrainPlayer subroutines have to be added to TrainPlayer before your TrainPlayer layout can be exported. Refer to the Quick Keys documentation.</p>
<p><A HREF="https://github.com/gar-codespace/QuickKeys-for-TrainPlayer">The Quick Keys page on GitHub</A></p>
<h4>Initialize Railroad</h4>
<p>Pressing this button initializes the Locations, Cars, and Engines data sets so a new JMRI railroad can be built from the TrainPlayer export. The Routes and Trains XML files are backed up.</p>
<h4>Import Locations</h4>
<p>Pressing this button builds a whole new JMRI railroad from the TrainPlayer export data. If you are using jPlus, the extended data you entered into the TrainPlayer layout will be added.</p>
<p>Additionally, when making any subsequent changes to the Locations panel of TrainPlayer's Advanced Ops window, re-export your TrainPlayer layout and press this button to update your JMRI data.</p>
<p>Pressing Import Locations also imports/updates Industries and Cars.</p>
<h4>Import Industries</h4>
<p>Press this button when you have made changes to TrainPlayers Advanced Ops Industries panel, This will update your spurs and their schedules. Any changes you have made to your rolling stock are also updated.</p>
<p>Pressing Import Industries also imports/updates Cars.</p>
<h4>Import Cars</h4>
<p>Press this button when you have made changes to the rolling stock on your TrainPlayer layout.</p>
<h4>Extended Detail</h4>
<p>Pressing this button will add the extended railroad details entered into the TrainPlayer Quick Keys Personalized Settings into jPlus. This is optional.</p>
<h3>Who does what</h3>
<p>One of the primary purposes of o2o is to eliminate duplication between your TrainPlayer and JMRI layouts. As much as possible, layout maintenance is done on your TrainPlayer layout and the changes are then pushed to your JMRI layout.</p>
<p>The table below shows which program manages which elements of your layout.</p>
<img src="../Subroutines_Activated/o2o/img/Who_Does_What.png" alt="<Who Does What Image>">
<p>Use TrainPlayer to manage Layout Details, Cars, Engines, Schedules, and Locations.</p>
<p>Use TrainPlayer to define Divisions and Tracks, and use JMRI to implement the details.</p>
<p>Use JMRI to manage all aspects of Routes and Trains.</p>
<p>As your JMRI layout becomes more nuanced, data set management will by necessity become increasingly shared (but not duplicated) between the two programs.</p>
<h3>Subroutine Panel</h3>
<p>Subroutines.o2o.View.ManageGui</p>
<img src="../Subroutines_Activated/o2o/img/o2o_Subroutine.png" alt="<o2o Subroutine Image>">
<h4>User Settings for the o2o section of configFile.json</h4>
<pre>
  The o2o section of the configuration file has the following user editable settings.
  The TrainPlayer car code lists are grouped by types of equipment, based on default TrainPlayer values.
  Any car code not listed is considered a manifest freight car.
  Custom car codes added to TrainPlayer would also be added here.

  "US" : {
    "XE" : [ <font color="DarkRed">List of TrainPlayer car codes for engines.</font>
      "E",
      "ES",
      "ED",
      "EE",
      "ET"
    ],
    "XP" : [ <font color="DarkRed">List of TrainPlayer car codes for passenger cars.</font>
      "EP",
      "CA",
      "CS",
      "D",
      "DA",
      "DB",
      "DC",
      "DL",
      "DO",
      "DP",
      "DPA",
      "P",
      "PA",
      "PAS",
      "PB",
      "PBC",
      "PBO",
      "PC",
      "PL",
      "PO",
      "PS",
      "PSA"
    ],
    "XX" : [ <font color="DarkRed">List of TrainPlayer car codes for baggage mail cars.</font>
      "B",
      "BE",
      "BH",
      "BM",
      "BMR",
      "BMT",
      "BP",
      "BR",
      "BX",
      "MA",
      "MB",
      "MR"
    ],
    "XC" : [ <font color="DarkRed">List of TrainPlayer car codes for cabeese.</font>
      "N",
      "NM",
      "NE"
    ],
    "XM" : [ <font color="DarkRed">List of TrainPlayer car codes for MOW equipment.</font>
      "M",
      "MWB",
      "MWC",
      "MWD",
      "MWG",
      "MWF",
      "MWK",
      "MWR",
      "MWX"
    ]
  },
</pre>
<!-- Patterns help section html -->
<h2>Patterns Subroutine</h2>
<h3>Description</h3>
<p>The Patterns subroutine can generate pattern reports for tracks at a single location. Additionally, cars can be moved from track to track within a location. Optionally, if a car is moved onto a spur, the schedule for that spur can be applied.</p>
<h3>How to use this subroutine</h3>
<p>If you are using divisions, the Division drop down will display a list of divisions. Selecting a division will load a list of locations for that division into the Location drop down.</p>
<p>With a location selected, a list of check boxes will display, one for each track at the selected location.</p>
<p>The list of tracks can be filtered by clicking the 'Spur Tracks Only' check box on or off.</p>
<p>Individual tracks can be selected by clicking the check box next to the track name.</p>
<p>With tracks selected, pressing the Pattern Report button will display inventory information (Pattern Report) about the selected tracks. This is printable.</p>
<p>If Tools/Options/Generate CSV Manifest is selected. The Pattern Report will be added to the csvManifests folder as a CSV file.</p>
<p>With tracks selected, pressing the Set Rolling Stock to Track button will pop open one worklist for each track selected.</p>
<p>For each worklist window, a row of buttons, one for each track of the selected location, will display. Pressing one of the track buttons will load the track name into memory.</p>
<p>For any of the rolling stock rows in the Cars At... panel, clicking inside of one of the text boxes will paste the selected track name into the box.</p>
<p>Pressing the + Switch List button will generate a switch list of work for that track. This is printable.</p>
<p>If Tools/Options/Generate CSV Switch List is selected. The switch list will be added to the csvSwitchLists folder as a CSV file.</p>
<p>If o2o is being used, a TrainPlayer work list will also be generated.</p>
<p>Pressing the Set Rolling Stock to Track button will open the Additional Choices pop up.</p>
<p>The pop up adds the option to use a spurs schedule and overide track capacity.</p>
<p>Pressing the Set Cars button will cause the rolling stock in the worklist to be moved to the selected track, subject to type restrictions.</p>
<h3>Subroutine Panel</h3>
<p>Subroutines.Patterns.View.ManageGui</p>
<img src="../Subroutines_Activated/Patterns/img/Pattern_Scripts_Subroutine.png" alt="<Pattern Scripts Subroutine Image>">
<h3>Pattern Report for Track Window</h3>
<p>Subroutines.Patterns.ControllerSetCarsForm.CreatePatternReportGui.makeFrame()</p>
<img src="../Subroutines_Activated/Patterns/img/Pattern_Report_For_Track.png" alt="<Pattern Report for Track Window Image>">
<h4>User Settings for the Patterns section of configFile.json</h4>
<pre>
  The Patterns section of the configuration file has the following user editable settings.
  
  "US" : {
    "DS" : "Not Assigned", <font color="DarkRed">Destination designator when the field would otherwise be blank.</font>
    "DT" : "Not Scheduled", <font color="DarkRed">Destination Track designator when the field would otherwise be blank.</font>
    "FD" : "Unconsigned", <font color="DarkRed">Final Destination designator when the field would otherwise be blank.</font>
    "FT" : "No Waybill", <font color="DarkRed">Final Destination and Track designator when the field would otherwise be blank.</font>
    "EH" : "Available", <font color="DarkRed">Extended Handling, special case designator for engine, passenger and caboose.</font>
    "SL": { <font color="DarkRed">Sort Locomotives</font>
      "model":1,
      "destination userName":0,
      "road":0
    },
    "SC" : { <font color="DarkRed">Sort Cars</font>
      "destination userName":0,
      "division":0,
      "finalDestination userName":1,
      "loadType":2,
      "road":0
    }
    For sorting, a zero means the field is not included, a one sorts that field first, a two sorts second, ETC.
</pre>
<!-- Scanner help section html -->
<h2>Scanner Subroutine</h2>
<h3>Add sequence date to JMRI cars</h3>
<p>Scanner adds car sequence data to the JMRI data cars data set.</P>
<h3>How to use this subroutine</h3>
<p>This subroutine is currently being prototyped</p>
<h3>Subroutine Panel</h3>
<p>Subroutines.Template.View.ManageGui</p>
<img src="../Subroutines_Activated/Scanner/img/Scanner_Subroutine.png" alt="<Scanner Subroutine Image>">
<h4>User Settings for the Template section of configFile.json</h4>
<pre>
  "US" : {
    "SP" : "" <font color="DarkRed">Scanner Path. Path to the scanner files</font>
}
</pre>
<!-- Throwback help section html -->
<h2>Throwback Subroutine</h2>
<h3>Description</h3>
<p>The Throwback Subroutine is modeled on the idea of version control software. Commits are named and saved. In so doing snapshots are taken of the JMRI railroad data sets.</p>
<p>The commit then serves as a setpoint that allows any of the JMRI data sets to be reset to.</p>
<p>Commits are useful for testing 'What if?' ideas, or to simulate an ops session in advance of the actual ops session, or for testing the movement of rolling stock ETC.</p>
<p>This subroutine does not interact with JMRIs Auto Save or Auto Backup feature, they run as configured.</p>
<h3>How to use this subroutine</h3>
<p>The name of each commit is entered into the text box of the Total Commits frame. Enter the name BEFORE pressing the Add New Commit button.</p>
<p>Presing the Add New Commit button will add a new commit.</p>
<p>Pressing the Delete All Commits brings up a choice to confirm or cancel the commit. Pressing the Confirm button erases all saved commits, so be careful!</p>
<p>In the Action panel, the Previous and Next buttons facilitate scrolling through your collection of commits. The list is ordered by creation date/time.</p>
<p>Select any combination of data sets to be thrown back by clicking its check box.</p>
<p>Pressing the Throwback button sets the selected data sets to the displayed commit.</p>
<h3>Plugin Layout</h3>
<p>Subroutines.Throwback.View.ManageGui()</p>
<img src="../Subroutines_Activated/Throwback/img/Throwbach_Subroutine.png" alt="<Plugin Layout Image>">
<h4>User Settings for the Throwback section of configFile.json</h4>
<pre>
  The Throwback section of the configuration file has no user editable settings.
</pre>

</body>
</html>
